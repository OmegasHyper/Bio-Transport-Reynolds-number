<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="main.css">
  <title>MATLAB Calculator</title>
</head>
<body>
  <div class="main-div">
      <div class="card">
      <h1>Reynolds Number Calculator</h1>
      <div id="reCalc">
        <label for="rho">Fluid Density (ρ) [kg/m³]</label>
        <input type="number" id="rho" placeholder="e.g. 1000" step="any" required />

        <label for="V">Fluid Velocity (v) [m/s]</label>
        <input type="number" id="V" placeholder="e.g. 2.5" step="any" required />

        <label for="L">Characteristic Length (L) [m]</label>
        <input type="number" id="L" placeholder="e.g. 0.05" step="any" required />

        <label for="mu">Dynamic Viscosity (μ) [Pa·s]</label>
        <input type="number" id="mu" placeholder="e.g. 0.001" step="any" required />

        <button onclick="sendToBackend()">Calculate</button>
      </div>

      <div id="res-load-container">
        <div id="loader" class="loader"></div>

        <div class="result" id="result"></div>
        <div class="regime" id="regime"></div>
      </div>


      <div class="formula">
        Formula: <b>Re = (ρ × v × L) / μ</b><br>
        Where:<br>
        ρ = fluid density<br>
        v = velocity<br>
        L = characteristic length<br>
        μ = dynamic viscosity
      </div>
    </div>
  </div>
 

  <script>
    async function sendToBackend() {
        const rho = document.getElementById('rho').value;
        const mu = document.getElementById('mu').value;
        const V = document.getElementById('V').value;
        const L = document.getElementById('L').value;
        
        const res = document.getElementById('result');
        const reg = document.getElementById('regime');
        const loader = document.getElementById('loader');

        try {
          reg.style.display = 'none';
          res.style.display = 'none';
          loader.style.display = 'block';
          const response = await fetch('/calculate', {
              method: 'POST',
              headers: {'Content-Type':'application/json'},
              body: JSON.stringify({rho, mu, V, L})
          });

          const data = await response.json();
          document.getElementById('result').innerText = data.result ?? "missing or invalid input";
          loader.style.display = "none"
          reg.style.display = 'block';
          res.style.display = 'block';

          if(data.result){
            document.getElementById('regime').className = ""
            document.getElementById('regime').innerText = Regime(data.result)
          }
        } catch (err) {
          loader.style.display = "none"
          reg.style.display = 'block';
          res.style.display = 'block';
          document.getElementById('result').innerText = err;
        }
      
        function Regime(result){
          if (result < 2000) {
            regime = "Laminar";
            document.getElementById('regime').classList.add("blue");
          }else if (result < 4000){
            document.getElementById('regime').classList.add("yellow");
            regime = "Transitional";
          }else{
            document.getElementById('regime').classList.add("red");
            regime = "Turbulent";
          }
          return regime;
        }
    }
  </script>
</body>
</html>
